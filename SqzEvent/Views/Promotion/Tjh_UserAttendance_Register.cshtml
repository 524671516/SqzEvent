@model SqzEvent.Models.Tjh_UserAttendance

@{
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=0,minimum-scale=1.0,maximum-scale=1.0" />
    <meta name="keywords" content="fullpage,jquery,demo,screen,fullscreen,backgrounds,full-screen" />
    <title>2017春糖会 参会报名</title>
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/jquery.fullPage.css" rel="stylesheet" />
    <link href="~/Content/font-awesome.min.css" rel="stylesheet" />
    <style>
        /*全局*/
        img {
            width: 100%;
            display: block;
        }

        select {
            -webkit-appearance: none;
        }

        h1 {
            margin: 0;
            padding: 0;
        }

        label {
            line-height: 2.234;
        }
        /*滑动块*/
        .down a {
            position: absolute;
            bottom: 0;
            left: 50%;
            z-index: 2;
            display: inline-block;
            -webkit-transform: translate(0, -50%);
            transform: translate(0, -50%);
            color: #fff;
            font: normal 400 20px/1 'Josefin Sans', sans-serif;
            letter-spacing: .1em;
            text-decoration: none;
            transition: opacity .3s;
            padding-top: 60px;
        }

            .down a:hover {
                opacity: .5;
            }

            .down a span {
                position: absolute;
                top: 0;
                left: 50%;
                width: 30px;
                height: 50px;
                margin-left: -15px;
                border: 2px solid #fff;
                border-radius: 50px;
                box-sizing: border-box;
            }

                .down a span::before {
                    position: absolute;
                    top: 10px;
                    left: 50%;
                    content: '';
                    width: 6px;
                    height: 6px;
                    margin-left: -3px;
                    background-color: #fff;
                    border-radius: 100%;
                    -webkit-animation: sdb10 2s infinite;
                    animation: sdb10 2s infinite;
                    box-sizing: border-box;
                }

        @@-webkit-keyframes sdb10 {
            0% {
                -webkit-transform: translate(0, 20px);
                opacity: 0;
            }

            40% {
                opacity: 1;
            }

            80% {
                -webkit-transform: translate(0, 0);
                opacity: 0;
            }

            100% {
                opacity: 0;
            }
        }

        @@keyframes sdb10 {
            0% {
                transform: translate(0, 20px);
                opacity: 0;
            }

            40% {
                opacity: 1;
            }

            80% {
                transform: translate(0, 0);
                opacity: 0;
            }

            100% {
                opacity: 0;
            }
        }
        /*表单*/
        .container {
            width: auto !important;
        }

        .selectwrap {
            padding: 0;
        }

        #AreaProvince {
            border-right: none;
        }

        .btn-disabled {
            color: #ccc !important;
        }

        .select.form-control {
            appearance: none;
            -moz-appearance: none;
            -webkit-appearance: none;
            padding: 0 0 0 15px;
            outline: none;
            text-decoration: none;
            background-color: #fff;
            -webkit-box-shadow: none;
            box-shadow: none;
        }

        .nopass::before {
            content: "\f096";
            font: normal normal normal 14px/1 FontAwesome;
            text-rendering: auto;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .pass::before {
            font: normal normal normal 14px/1 FontAwesome;
            text-rendering: auto;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            content: "\f046";
        }

        .bg-bg {
            border-left: none;
            border-right: none;
            color: #fff !important;
            background-color: #4cae4c !important;
            border-color: #4cae4c !important;
        }

        .border-error {
            border-color: #a94442 !important;
        }


        .border-success {
            border-color: #4cae4c;
        }

        .inputwrap {
            padding-left: 0;
        }

        @@media screen and (max-width: 320px) {
            .container {
                padding-top: 2%;
            }

                .container .form-group {
                    margin-bottom: 5%;
                }
        }

        @@media screen and (min-width:321px)and (max-width: 375px) {
            .container {
                padding-top: 8%;
            }

                .container .form-group {
                    margin-bottom: 10%;
                }
        }

        @@media screen and (min-width:376px)and (max-width: 480px) {
            .container {
                padding-top: 5%;
            }

                .container .form-group {
                    margin-bottom: 9%;
                }
        }
        /*fullpage*/
        #footer_pic {
            padding: 0px 6px 0 6px;
        }

        #header_pic {
            padding: 10% 6px 0 6px;
        }

        #fp-nav.right {
            right: 0 !important;
        }

        #fp-nav ul li a span, .fp-slidesNav ul li a span {
            border: 1px solid #AAA;
            background: rgba(0, 0, 0, 0);
        }

        .section {
            text-align: center;
            background-size: cover;
        }

        #section0 {
            background-image: url(/Content/Content/images/0306-H5-1.jpg);
        }

        #section1 {
            background-image: url(/Content/Content/images/0306-H5-2.jpg);
        }

        #section4 {
            background: url('../../Content/Content/images/bg0042.png') repeat;
            background-size: contain;
        }

        .section .container {
            margin: 0 6px;
            background: url('../../Content/Content/images/bg0041c.png');
            background-size: 100%;
        }

        .ui-content {
            display: none;
            color: #fff;
            font-size: 2rem;
            top: 0;
            background-color: rgba(0, 0, 0, 0.85);
            display: block;
            position: fixed;
            left: 0;
            vertical-align: middle;
            width: 100%;
            height: 100%;
            text-align: center;
            margin: 0 auto;
            z-index: -1;
            font-weight: 700;
        }

            .ui-content div {
                width: 90%;
                left: 0;
                right: 0;
                margin: 0 auto;
                position: absolute;
                top: 20%;
            }

        .btn-disabled {
            background-color: #ccc;
            color: #fff !important;
            border-color: #ccc;
        }
    </style>

    <!--[if IE]>
        <script type="text/javascript">
             var console = { log: function() {} };
        </script>
    <![endif]-->

</head>
<body>
    <div data-role="main" class="ui-content">
        <div>
            <i>请试着旋转您的设备！</i>
            <br />
            <p><b>注意</b>请在竖屏状态下观看</p>
        </div>
    </div>
    <div id="fullpage">
        <div class="section " id="section0">
            <div id="huadong" class="down">
                <a href="javascript:;"><span></span></a>
            </div>
        </div>
        <div class="section" id="section1">
            <div id="huadong" class="down">
                <a href="javascript:;"><span></span></a>
            </div>
        </div>
        <div class="section" id="section4">
            <div id="header_pic">
                <img src="~/Content/Content/images/bg0041h.png" />
            </div>
            <div class="container">
                <div class="col-xs-12" id="register">
                    @using (Html.BeginForm("Tjh_UserAttendance_Register", "Promotion", FormMethod.Post, new { @class = "form-horizontal", id = "create-form" }))
                    {
                        @Html.AntiForgeryToken()
                        @Html.HiddenFor(m => m.Id)
                        @Html.HiddenFor(m => m.openid)
                        @Html.HiddenFor(m => m.SignupDatetime)
                        @Html.HiddenFor(m => m.Confirmed)
                        @Html.HiddenFor(m => m.ConfirmedDatetime)
                        <input type="hidden" value="" name="Area" id="Area" />
                        <input type="hidden" value="" name="SalesChannel" id="SalesChannel" />
                        <div class="form-group">
                            <div class="col-xs-12 selectwrap">
                                @Html.TextBoxFor(m => m.Name, new { @class = "form-control input-lg", placeholder = "姓名" })
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-xs-12 selectwrap">
                                @Html.TextBoxFor(m => m.Mobile, new { @class = "form-control input-lg", @type = "tel", placeholder = "手机号码" })
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-xs-12">
                                <div class="row">
                                    <div class="col-xs-6 selectwrap">
                                        <select id="AreaProvince" class="form-control select border-none input-lg area">
                                            <option>请选择省</option>
                                        </select>
                                    </div>
                                    <div class="col-xs-6 selectwrap">
                                        <select id="AreaCity" class="form-control select border-none input-lg area">
                                            <option>请选择市</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-xs-12">
                                <div class="row">
                                    <div class="btn-group col-xs-12 selectwrap">
                                        <label class="btn btn-lg btn-default  col-xs-6 nopass" for="checkbox1">
                                            <input type="checkbox" value="KA" id="checkbox1" name="checkbox" class="hidden">KA
                                        </label>
                                        <label class="btn btn-lg btn-default col-xs-6 nopass" for="checkbox2">
                                            <input type="checkbox" value="流通" id="checkbox2" name="checkbox" class="hidden">流通
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                            <div class="form-group">
                                <div class="col-xs-12 selectwrap">
                                    @Html.TextBoxFor(m => m.RecommandUser, new { @class = "form-control input-lg", placeholder = "推荐人" })
                                </div>
                            </div>
                    }
                    <div class="form-group">
                        <div class="col-xs-2"></div>
                        <div class="col-xs-8"><a class="btn btn-success btn-block btn-lg" id="register-btn">立即报名</a></div>
                        <div class="col-xs-2"></div>
                    </div>
                </div>
            </div>
            <div id="footer_pic">
                <img src="~/Content/Content/images/bg0041f.png" />
            </div>
        </div>
    </div>
    <div class="hidden">
        <span id="appId">@ViewBag.AppId</span>
        <span id="timeStamp">@ViewBag.TimeStamp</span>
        <span id="nonce">@ViewBag.Nonce</span>
        <span id="url">@ViewBag.Url</span>
        <span id="signature">@ViewBag.Signature</span>
    </div>
    <script src="~/Scripts/jquery-1.10.2.min.js"></script>
    <script src="~/Scripts/scrolloverflow.min.js"></script>
    <script src="~/Scripts/jquery.fullPage.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="https://res.wx.qq.com/open/js/jweixin-1.0.0.js" type="text/javascript"></script>
    <script>
        wx.config({
            debug: false,
            // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。
            appId: $("#appId").text(),
            // 必填，公众号的唯一标识
            timestamp: $("#timeStamp").text(),
            // 必填，生成签名的时间戳
            nonceStr: $("#nonce").text(),
            // 必填，生成签名的随机串
            signature: $("#signature").text(),
            // 必填，签名，见附录1
            jsApiList: ["onMenuShareTimeline", "onMenuShareAppMessage", "onMenuShareQQ", "onMenuShareWeibo", "onMenuShareQZone"]
        });
        wx.ready(function () {
            wx.onMenuShareTimeline({
                title: '寿全斋2017年成都春糖会-参展商邀请函', // 分享标题
                link: 'https://event.shouquanzhai.cn/Promotion/Tjh_UserAttendanceStart?type=1', // 分享链接
                imgUrl: 'http://cdn.shouquanzhai.cn/Content/Fifv3dKQ7o35TXS0go3CyeiQTzVe.jpg', // 分享图标
                success: function () {
                    // 用户确认分享后执行的回调函数
                    alert("分享");
                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                    alert("未分享");
                }
            });
            wx.onMenuShareAppMessage({
                title: '寿全斋2017年成都春糖会-参展商邀请函', // 分享标题
                desc: '', // 分享描述
                link: 'https://event.shouquanzhai.cn/Promotion/Tjh_UserAttendanceStart?type=1', // 分享链接
                imgUrl: 'http://cdn.shouquanzhai.cn/Content/Fifv3dKQ7o35TXS0go3CyeiQTzVe.jpg', // 分享图标
                type: '', // 分享类型,music、video或link，不填默认为link
                dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
                success: function () {
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                }
            });
            wx.onMenuShareQQ({
                title: '寿全斋2017年成都春糖会-参展商邀请函', // 分享标题
                desc: '', // 分享描述
                link: 'https://event.shouquanzhai.cn/Promotion/Tjh_UserAttendanceStart?type=1', // 分享链接
                imgUrl: 'http://cdn.shouquanzhai.cn/Content/Fifv3dKQ7o35TXS0go3CyeiQTzVe.jpg', // 分享图标
                success: function () {
                    // 用户确认分享后执行的回调函数

                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                }
            });
            wx.onMenuShareWeibo({
                title: '寿全斋2017年成都春糖会-参展商邀请函', // 分享标题
                desc: '', // 分享描述
                link: 'https://event.shouquanzhai.cn/Promotion/Tjh_UserAttendanceStart?type=1', // 分享链接
                imgUrl: 'http://cdn.shouquanzhai.cn/Content/Fifv3dKQ7o35TXS0go3CyeiQTzVe.jpg', // 分享图标
                success: function () {
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                }
            });
            wx.onMenuShareQZone({
                title: '寿全斋2017年成都春糖会-参展商邀请函', // 分享标题
                desc: '', // 分享描述
                link: 'https://event.shouquanzhai.cn/Promotion/Tjh_UserAttendanceStart?type=1', // 分享链接
                imgUrl: 'http://cdn.shouquanzhai.cn/Content/Fifv3dKQ7o35TXS0go3CyeiQTzVe.jpg', // 分享图标
                success: function () {
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () {
                    // 用户取消分享后执行的回调函数
                }
            });
        });
        var initwidth = "";
        var _clientheight = $(window).height();
        var _clientwidth = $(window).width();
        if (_clientheight < _clientwidth) {
            $(".ui-content").css("display", "block");
            $(".ui-content").css("z-index", "999");
            initwidth = _clientheight;
        } else {
            $(".ui-content").css("display", "none");
            $(".ui-content").css("z-index", "-1");
            initwidth = _clientwidth;
        }
        $(window).resize(function () {
            var clientheight = $(window).height();
            var clientwidth = $(window).width();
            if (clientwidth == initwidth) {
                $(".ui-content").css("display", "none");
                $(".ui-content").css("z-index", "-1");
            } else {
                if (_clientwidth < clientheight && _clientwidth < clientwidth) {
                    $(".ui-content").css("display", "none");
                    $(".ui-content").css("z-index", "-1");
                } else {
                    if (clientheight < clientwidth) {
                        $(".ui-content").css("display", "block");
                        $(".ui-content").css("z-index", "999");
                    } else {
                        $(".ui-content").css("display", "none");
                        $(".ui-content").css("z-index", "-1");
                    }
                }
            }
        });
        
        $(document).ready(function () {
            
            $('#fullpage').fullpage({
                autoScrolling: true,
                verticalCentered: false,
                css3: true,
                navigation: true,
                navigationPosition: 'right',
                navigationTooltips: ['第一页', '第二页', '第三页', '第四页'],
                afterResponsive: function (isResponsive) {

                },
            });
        });

        //var recommend_type = /^(13[0-9]|14[0-9]|15[0-9]|18[0-9])\d{8}$|^\d{0}$/   //推荐码正则
        var verification_type = /^\d{4,6}$/                                       //验证码正则
        var word_type = /^[\u4e00-\u9fa5]{1,6}$/                                  //输入姓名正则
        var tel_type = /^(13[0-9]|14[0-9]|15[0-9]|18[0-9])\d{8}$/                 //电话号码正则
        $.ajax({
            url: "/Seller/GetRegion",
            data: {
                level: 1
            },
            success: function (data) {
                var data = JSON.parse(data);
                for (i = 0; i < data.response.regions.length; i++) {
                    var province = unescape(data.response.regions[i].name);
                    var province_val = data.response.regions[i].id;
                    $("#AreaProvince").append("<option target-id=\"" + province_val + "\" value=\"" + province + "\">" + province + "</option>");
                }
            }
        });
        $("label").on("click", function () {
            if ($(this).hasClass("pass")) {
                $(this).find("input").prop("checked", false);
                $(this).removeClass("bg-bg");
                $(this).removeClass("pass");
                return false;
            } else {
                $(this).find("input").prop("checked", true);
                $(this).addClass("bg-bg");
                $(this).addClass("pass");
                return false;
            }
        });

        /*选择省后获取对应市级信息*/
        $("#AreaProvince").on("change", function () {
            $("#Area").val("");
            $("#AreaCity").html("<option>请选择市</option>");
            $.ajax({
                url: "/Seller/GetRegion",
                data: {
                    parentid: $("#AreaProvince").find("option:selected").attr("target-id"),
                    level: 2
                },
                success: function (data) {
                    var data = JSON.parse(data);
                    if ($("#AreaProvince").find("option:selected").attr("target-id") > 0) {
                        for (i = 0; i < data.response.regions.length; i++) {
                            var city = unescape(data.response.regions[i].name);
                            var city_val = data.response.regions[i].id;
                            $("#AreaCity").append("<option target-id=\"" + city_val + "\" value=\"" + city + "\">" + city + "</option>");
                        }
                    }
                }
            });
        });
        $("#AreaCity").on("change", function () {
            $("#Area").val("");
        });
        $("#register-btn").on("click", function () {
            $("#SalesChannel").val("");
            $("#Area").val("");
            var bool = true;
            var check = false;
            if (!$(this).hasClass("btn-disabled")) {
                $(this).addClass("btn-disabled");
                if (!word_type.test($("#Name").val())) {
                    $("#Name").parent().addClass("has-error");
                    $("#Name").val("");
                    $("#Name").attr("placeholder", "请输入合法的姓名")
                    $(this).removeClass("btn-disabled");
                    bool = false;
                } else {
                    $("#Name").parent().removeClass("has-error");
                    $("#Name").parent().addClass("has-success");
                }
                if (!tel_type.test($("#Mobile").val())) {
                    $("#Mobile").parent().addClass("has-error");
                    $("#Mobile").val("");
                    $("#Mobile").attr("placeholder", "请输入合法的手机号");
                    $(this).removeClass("btn-disabled");
                    bool = false;
                } else {
                    $("#Mobile").parent().removeClass("has-error");
                    $("#Mobile").parent().addClass("has-success");
                }
                $("select").each(function () {
                    if ($(this).val() == "请选择市" || $(this).val() == "请选择省") {
                        $(this).parent().addClass("has-error");
                        $("#register-btn").removeClass("btn-disabled");
                        bool = false;
                    } else {
                        $(this).parent().removeClass("has-error");
                        $(this).parent().addClass("has-success");
                    }
                });
                $("input[type='checkbox']").each(function () {
                    if ($(this).is(":checked")) {
                        check = true;
                    }
                });
                if (check == false) {
                    $("input[type='checkbox']").parent().addClass("border-error");
                    alert("请选择渠道");
                } else {
                    $("input[type='checkbox']").parent().removeClass("border-error");
                }
                if (bool) {
                    $(".area").each(function () {
                        $("#Area").val($("#Area").val() + $(this).val() + ",");
                    });
                    $("input[type=checkbox]").each(function () {
                        if ($(this).is(":checked")) {
                            $("#SalesChannel").val($("#SalesChannel").val() + $(this).val() + ",");
                        }
                    });
                    $("#SalesChannel").val(($("#SalesChannel").val()).substring(0, ($("#SalesChannel").val()).length - 1));
                    $("#Area").val(($("#Area").val()).substring(0, ($("#Area").val()).length - 1));
                    $("#create-form").submit();
                }
            } else {
                $(this).addClass("btn-disabled");
            }
        })
    </script>
</body>
</html>